<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horizontal Animation</title>
    <link rel="stylesheet" href="/css/index.css" type="text/css" media="all" />
    <script type="module" src="/js/index.js"></script>
</head>
<body>
<main>
    <div class="slider-container">
        <ul class="ul-slider">
            <li style="background: #00FF00">
                0 a
                <iframe width="100%" width="100%" height="600" border="0" src="http://test.elchalanaruba.com"></iframe>
            </li>
            <li style="background: #1b91ff">
                1 b
                <iframe width="100%" height="600" border="0" src="http://test.eduardoaf.com"></iframe>
            </li>
            <li style="background: #e6b1ef">
                2 c
                <iframe width="100%" height="600" border="0" src="http://test.mypromos.es"></iframe>
            </li>
            <li style="background: #ff8c00">
                3 d
                <iframe width="100%" height="600" border="0" src="http://theframework.es"></iframe>
            </li>
            <li style="background: #a92ecb">
                4 e
                <iframe width="100%" height="600" border="0" src="http://helpers.theframework.es"></iframe>
            </li>
            <li style="background: #1eb5c9">
                5 f
                <iframe width="100%" height="600" border="0" src="http://ipblocker.theframework.es"></iframe>
            </li>
        </ul>
        <nav class="slider-nav">
            <p>total items</p>
            <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
            <a class="prev">prev</a>
            <span>&nbsp;&nbsp;|&nbsp;&nbsp;</span>
            <a class="next">next</a>
        </nav>
    </div>
</main>
<script type="module">
let currLi = 0
let autoAnimation = true

const $lis = Array.from(document.querySelectorAll(".ul-slider li"))
const NUM_LIS = $lis.length
const LAST_LI = NUM_LIS - 1

if (NUM_LIS<2) autoAnimation = false

const configNav = () => {
    const $prev = document.querySelector(".prev")
    $prev.addEventListener("click", () => {
        const old = currLi
        currLi = currLi - 1
        if (currLi < 0) currLi = LAST_LI
        window.dispatchEvent(new CustomEvent("navClicked", {
            detail: {
                ev: "prev",
                prevli: old,
                currli: currLi
            }
        }))
    })
    const $next = document.querySelector(".next")
    $next.addEventListener("click", () => {
        const old = currLi
        currLi = currLi + 1
        if (currLi > LAST_LI) currLi = 0
        window.dispatchEvent(new CustomEvent("navClicked", {
            detail: {
                ev: "next",
                prevli: old,
                currli: currLi
            }
        }))
    })
}
configNav()

const configLis = () => {
    $lis.forEach($li => {
        $li.hide = () => {
            $li.style.left= "0px"
            $li.classList.remove("li-animation-in")
            $li.classList.add("li-animation-out")
        }

        $li.show = () => {
            $li.style.left= "-800px"
            $li.classList.remove("li-animation-out")
            $li.classList.add("li-animation-in")
        }
    })
}
configLis()

const get_li_by_position = position => $lis.filter(($li, pos)=> position===pos)[0] ?? null

const animate = () => {
    const $liShow = get_li_by_position(currLi)
    $liShow.show()
    const pid = setInterval(() => {
        if (!autoAnimation) {
            clearInterval(pid)
            return
        }
        const old = currLi
        currLi = currLi + 1
        if (currLi>LAST_LI) currLi = 0

        const $liHide = get_li_by_position(old)
        $liHide.hide()

        const $liShow = get_li_by_position(currLi)
        $liShow.show()
    },5000)
}
animate()

window.addEventListener("navClicked", function(ev) {
    autoAnimation = false
    let $li = get_li_by_position(ev.detail.prevli)
    $li.hide()
    $li = get_li_by_position(ev.detail.currli)
    $li.show()
})
</script>
</body>
</html>