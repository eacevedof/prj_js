<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horizontal Animation</title>
    <link rel="stylesheet" href="/css/index.css" type="text/css" media="all" />
    <script type="module" src="/js/index.js">
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
<main>
    <div class="slider-container">
        <ul class="ul-slider">
            <li style="background: #00FF00">a</li>
            <li style="background: #1b91ff">b</li>
            <li style="background: #6a1520">c</li>
        </ul>
        <nav class="slider-nav">
            <a class="prev">prev</a> | <a class="next">next</a>
        </nav>
    </div>
</main>
<script type="module">
let currLi = 0
const $lis = Array.from(document.querySelectorAll(".ul-slider li"))
const NUM_LIS = $lis.length
const LAST_LI = NUM_LIS - 1
const navClick = new Event("navClicked")
    
const $prev = document.querySelector(".prev")
$prev.addEventListener("click", () => {
    currLi = currLi - 1
    if (currLi<0) currLi = 0
    console.log("prev",currLi)
    window.dispatchEvent(navClick)
})
const $next = document.querySelector(".next")
$next.addEventListener("click", () => {
    currLi = currLi + 1
    if (currLi>LAST_LI) currLi = 0
    console.log("next",currLi)
    window.dispatchEvent(navClick)
})

const configLis = () => {
    $lis.forEach($li => {
        $li.hide = () => {
            $li.style.left= "0px"
            $li.classList.remove("li-animation-in")
            $li.classList.add("li-animation-out")
        }

        $li.show = () => {
            $li.style.left= "-800px"
            $li.classList.remove("li-animation-out")
            $li.classList.add("li-animation-in")
        }
    })
}
configLis()

const get_li_by_position = position => $lis.filter(($li, pos)=> position===pos)[0] ?? null

const animate = function ( ) {
    const pid = setInterval(() => {
        const old = currLi
        currLi = currLi + 1
        if (currLi>LAST_LI) currLi = 0

        console.log("animate","hide", old, "show", currLi)
        const $liHide = get_li_by_position(old)
        $liHide.hide()

        const $liShow = get_li_by_position(currLi)
        $liShow.show()
    },7000)
}
animate()

window.addEventListener("navClicked", () => {
    console.log("navClicked")
})
</script>
</body>
</html>